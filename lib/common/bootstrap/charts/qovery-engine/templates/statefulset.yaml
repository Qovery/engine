---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: {{ include "qovery-engine.serviceAccountName" . }}
  namespace: {{ .Values.namespace }}
  labels:
    {{- include "qovery-engine.labels" . | nindent 4 }}
spec:
    volumeMounts:
      - name: {{ s.id }}
        mountPath: {{ .Values.volumes.qoveryWorkspace.path }}
      - name: {{ s.id }}
        mountPath: {{ .Values.volumes.dockerGraphStorage.path }}

volumeClaimTemplates:
- metadata:
    name: dockerGraphStorage
    labels:
    {{- include "qovery-engine.labels" . | nindent 4 }}
  spec:
    accessModes:
      - ReadWriteOnce
    storageClassName: aws-ebs-gp2-0
    resources:
      requests:
        storage: {{ .Values.volumes.dockerGraphStorage.size }}
- metadata:
    name: qoveryWorkspace
    labels:
    {{- include "qovery-engine.labels" . | nindent 4 }}
  spec:
    accessModes:
      - ReadWriteOnce
    storageClassName: aws-ebs-gp2-0
    resources:
      requests:
        storage: {{ .Values.volumes.qoveryWorkspace.size }}
